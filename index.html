<!DOCTYPE html>
<html>
  <head>
    <title>Toamig</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="logo_head.svg" type="image/svg+xml">
    <link rel="stylesheet" type="text/css" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script>
      // Add smooth scroll behavior when arrow is pressed
      document.addEventListener('DOMContentLoaded', function() {
        var scrollDownArrow = document.querySelector('.scroll-down a');
        if (scrollDownArrow) {
          scrollDownArrow.addEventListener('click', function(event) {
            event.preventDefault();
            var target = document.querySelector(this.getAttribute('href'));
            if (target) {
              target.scrollIntoView({ behavior: 'smooth' });
            }
          });
        }

        // Hamburger menu toggle
        var hamburger = document.querySelector('.hamburger');
        var navMenu = document.querySelector('.nav-menu');
        if (hamburger && navMenu) {
          hamburger.addEventListener('click', function() {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
            document.body.classList.toggle('menu-open');
          });

          // Close menu when clicking on a link
          var navLinks = navMenu.querySelectorAll('a');
          navLinks.forEach(function(link) {
            link.addEventListener('click', function() {
              hamburger.classList.remove('active');
              navMenu.classList.remove('active');
              document.body.classList.remove('menu-open');
            });
          });

          // Close menu when clicking outside
          document.addEventListener('click', function(event) {
            if (!hamburger.contains(event.target) && !navMenu.contains(event.target)) {
              hamburger.classList.remove('active');
              navMenu.classList.remove('active');
              document.body.classList.remove('menu-open');
            }
          });
        }

        // Music Player - Cross-page persistence with seamless playback
        var musicPlayer = document.getElementById('backgroundMusic');
        var musicToggle = document.getElementById('musicToggle');
        var musicIcon = document.getElementById('musicIcon');
        
        if (musicPlayer && musicToggle) {
          // Detect if this is a fresh load (hard refresh, browser restart) vs navigation
          var isNavigating = sessionStorage.getItem('isNavigating') === 'true';
          var navigationType = performance.getEntriesByType('navigation')[0]?.type;
          var isReload = navigationType === 'reload';
          var referrer = document.referrer || '';
          var currentOrigin = window.location.origin;
          var isFromSameSite = referrer && referrer.indexOf(currentOrigin) === 0;
          
          // Only consider it navigation if we came from the same site AND the flag was set
          // This ensures we only restore music state for actual internal navigation
          var isInternalNavigation = isNavigating && isFromSameSite;
          var isHardRefresh = isReload && !isInternalNavigation;
          
          // Get user preference (persists across hard resets)
          var userPreference = localStorage.getItem('musicUserPreference'); // 'playing' or 'stopped'
          
          // If this is a fresh load (hard refresh, new browser session, or external link), reset navigation state
          // But keep user preference for persistent behavior
          if (!isInternalNavigation || isHardRefresh) {
            localStorage.removeItem('musicPlaying');
            localStorage.removeItem('musicStopped');
            localStorage.removeItem('musicTime');
          }
          
          // Always clear the navigation flag on page load - it will be set again if user clicks internal link
          // This prevents stale flags from causing issues after clicking external links
          sessionStorage.removeItem('isNavigating');
          
          // Set volume to 50%
          musicPlayer.volume = 0.5;
          
          // Check saved state (after potential reset)
          // User preference always takes precedence - if user paused, respect that across all pages
          var wasPlaying = false;
          var wasStopped = false;
          var savedTime = 0;
          
          // First check user preference - if user paused, always respect that
          if (userPreference === 'stopped') {
            wasStopped = true;
            wasPlaying = false;
            savedTime = 0;
          } else if (isInternalNavigation) {
            // Internal navigation: use navigation state for seamless playback
            // Only if user hasn't explicitly stopped
            wasPlaying = localStorage.getItem('musicPlaying') === 'true';
            wasStopped = localStorage.getItem('musicStopped') === 'true';
            savedTime = parseFloat(localStorage.getItem('musicTime')) || 0;
          } else {
            // Fresh load or hard refresh: use user preference
            wasStopped = userPreference === 'stopped';
            wasPlaying = userPreference === 'playing';
            savedTime = 0; // Start from beginning on fresh load/hard refresh
          }
          
          // Function to save playing state and position
          function savePlayingState() {
            if (!musicPlayer.paused) {
              localStorage.setItem('musicPlaying', 'true');
              localStorage.setItem('musicStopped', 'false');
              localStorage.setItem('musicTime', musicPlayer.currentTime.toString());
              // Save user preference (persists across hard resets)
              localStorage.setItem('musicUserPreference', 'playing');
            }
          }
          
          // Function to save paused state
          function savePausedState() {
            localStorage.setItem('musicStopped', 'true');
            localStorage.setItem('musicPlaying', 'false');
            localStorage.setItem('musicTime', musicPlayer.currentTime.toString());
            // Save user preference (persists across hard resets)
            localStorage.setItem('musicUserPreference', 'stopped');
          }
          
          // Wait for audio to be ready before restoring position
          musicPlayer.addEventListener('loadedmetadata', function() {
            // Restore playback position if music was playing
            if (wasPlaying && !wasStopped && savedTime > 0) {
              musicPlayer.currentTime = savedTime;
            }
          });
          
          // Resume playing if it was playing and user hasn't stopped it
          if (wasPlaying && !wasStopped) {
            // Wait for audio to load and set position
            musicPlayer.addEventListener('canplaythrough', function() {
              if (savedTime > 0) {
                musicPlayer.currentTime = savedTime;
              }
              musicPlayer.play().then(function() {
                musicIcon.textContent = '⏸';
              }).catch(function(error) {
                console.log('Autoplay blocked by browser:', error);
                musicIcon.textContent = '▶';
              });
            }, { once: true });
            
            // Also try to load the audio
            musicPlayer.load();
          } else if (!wasStopped) {
            // First visit - try to autoplay
            setTimeout(function() {
              musicPlayer.play().then(function() {
                musicIcon.textContent = '⏸';
              }).catch(function(error) {
                console.log('Autoplay blocked by browser:', error);
                musicIcon.textContent = '▶';
              });
            }, 100);
          } else {
            // User had stopped it - restore position but don't play
            if (savedTime > 0) {
              musicPlayer.addEventListener('loadedmetadata', function() {
                musicPlayer.currentTime = savedTime;
              }, { once: true });
              musicPlayer.load();
            }
            musicIcon.textContent = '▶';
          }
          
          // Update icon and save state when playing
          musicPlayer.addEventListener('play', function() {
            musicIcon.textContent = '⏸';
            savePlayingState();
          });
          
          // Update icon and save state when paused
          musicPlayer.addEventListener('pause', function() {
            musicIcon.textContent = '▶';
            // Only mark as stopped if music was actually playing (not just failed to start)
            if (musicPlayer.currentTime > 0 || wasPlaying) {
              savePausedState();
            }
          });
          
          // Save position continuously while playing (for seamless cross-page navigation)
          var saveInterval = setInterval(function() {
            if (!musicPlayer.paused) {
              localStorage.setItem('musicTime', musicPlayer.currentTime.toString());
            }
          }, 200); // Save position every 200ms for seamless transition
          
          // Toggle play/pause on button click
          musicToggle.addEventListener('click', function() {
            if (musicPlayer.paused) {
              musicPlayer.play();
            } else {
              musicPlayer.pause();
            }
          });
          
          // Track clicks on links to set navigation flag
          document.addEventListener('click', function(e) {
            var link = e.target.closest('a');
            if (link && link.href) {
              try {
                var linkUrl = new URL(link.href, window.location.href);
                var currentUrl = new URL(window.location.href);
                var isSameOrigin = linkUrl.origin === currentUrl.origin;
                var opensInNewTab = link.target === '_blank' || link.hasAttribute('target');
                
                if (isSameOrigin && !opensInNewTab) {
                  // Internal link that navigates in same tab - set flag for seamless navigation
                  sessionStorage.setItem('isNavigating', 'true');
                } else if (!isSameOrigin) {
                  // External link (different origin) - clear flag to reset on return
                  sessionStorage.removeItem('isNavigating');
                }
                // Same-origin links with target="_blank" (like PDFs) don't affect flag
                // This allows music to continue when opening files on same site
              } catch (err) {
                // Invalid URL, clear flag to be safe
                sessionStorage.removeItem('isNavigating');
              }
            }
          }, true);
          
          // Save state before page unload (for cross-page persistence)
          window.addEventListener('beforeunload', function() {
            clearInterval(saveInterval);
            // Only save if we're actually navigating internally (flag was set)
            if (sessionStorage.getItem('isNavigating') === 'true') {
              if (!musicPlayer.paused) {
                localStorage.setItem('musicPlaying', 'true');
                localStorage.setItem('musicStopped', 'false');
                localStorage.setItem('musicTime', musicPlayer.currentTime.toString());
              } else {
                localStorage.setItem('musicPlaying', 'false');
                localStorage.setItem('musicTime', musicPlayer.currentTime.toString());
              }
            }
          });
          
          // Also save on pagehide (more reliable than beforeunload)
          window.addEventListener('pagehide', function() {
            clearInterval(saveInterval);
            // Only save if we're actually navigating internally (flag was set)
            if (sessionStorage.getItem('isNavigating') === 'true') {
              if (!musicPlayer.paused) {
                localStorage.setItem('musicPlaying', 'true');
                localStorage.setItem('musicStopped', 'false');
                localStorage.setItem('musicTime', musicPlayer.currentTime.toString());
              } else {
                localStorage.setItem('musicPlaying', 'false');
                localStorage.setItem('musicTime', musicPlayer.currentTime.toString());
              }
            }
          });
          
          // Save on visibility change (when user switches tabs)
          document.addEventListener('visibilitychange', function() {
            if (!musicPlayer.paused) {
              savePlayingState();
            }
          });
        }
      });
    </script>
    <script src="headerscript.js"></script>
  </head>
  <body>
    <!-- Music Player -->
    <div class="music-player" id="musicPlayer">
      <button class="music-toggle" id="musicToggle" aria-label="Toggle music">
        <span class="music-icon" id="musicIcon">▶</span>
      </button>
      <audio id="backgroundMusic" loop>
        <!-- Replace with your music file path -->
        <source src="music/AC DC - Shoot To Thrill.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </div>
    <!-- Header -->
    <header>
      <nav> 
        <div id="header-placeholder">
          <svg id="my-logo" class="logo-header" alt="Logo" version="1.0" xmlns="http://www.w3.org/2000/svg" width="689.000000pt" height="633.000000pt" viewBox="0 0 689.000000 633.000000" preserveAspectRatio="xMidYMid meet">
            <g id="logosvg" transform="translate(0.000000,633.000000) scale(0.100000,-0.100000)" stroke="none" fill="#ffffff">
              <path id="logo-variable" d="M507 4863 c-4 -3 -7 -152 -7 -330 l0 -323 335 0 335 0 0 -1332 0
              -1333 330 330 330 330 0 1002 0 1003 999 0 1000 0 323 326 c178 179 325 327
              327 330 2 2 -889 4 -1981 4 -1091 0 -1988 -3 -1991 -7z" style="fill: #2980b9"/>
              <path d="M4227 4472 l-327 -327 -2 -1005 -3 -1005 -1000 -3 -1000 -2 -330
              -330 -330 -330 1658 0 1657 0 0 335 0 335 392 -2 393 -3 123 -215 c68 -118
              154 -267 191 -330 l67 -115 377 -3 c207 -1 377 0 377 3 0 2 -22 42 -49 87 -46
              77 -1130 1958 -1218 2113 -22 39 -84 147 -138 240 -54 94 -130 226 -170 295
              -40 69 -98 170 -130 225 -32 55 -91 158 -132 230 -41 71 -75 130 -76 132 -2 1
              -150 -145 -330 -325z m375 -1064 c20 -35 104 -181 187 -325 83 -144 151 -267
              151 -273 0 -6 -67 -10 -195 -10 l-195 0 0 335 c0 184 4 335 8 335 4 0 24 -28
              44 -62z"/>
              <path d="M2898 3139 l-318 -324 317 -3 c174 -1 318 -1 320 1 2 2 2 149 1 327 l-3 323 -317 -324z"/>
            </g>
          </svg>
        </div>
        <button class="hamburger" aria-label="Toggle menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <div class="nav-menu">
          <a href="index.html">Home</a>
          <a href="about.html">About</a>
          <a href="me/Miguel's CV.pdf" target="_blank" rel="noopener noreferrer">Resume</a>
        </div>
      </nav>
    </header>

    <div class="front-page">
      <div class="front-page-content">
        <div class="branding">
          <div id="branding-placeholder">
            <svg id="my-logo" class="logo" alt="Logo" version="1.0" xmlns="http://www.w3.org/2000/svg" width="689.000000pt" height="633.000000pt" viewBox="0 0 689.000000 633.000000" preserveAspectRatio="xMidYMid meet">
              <g id="logosvg" transform="translate(0.000000,633.000000) scale(0.100000,-0.100000)" stroke="none" fill="#ffffff">
                <path id="logo-variable" d="M507 4863 c-4 -3 -7 -152 -7 -330 l0 -323 335 0 335 0 0 -1332 0
                -1333 330 330 330 330 0 1002 0 1003 999 0 1000 0 323 326 c178 179 325 327
                327 330 2 2 -889 4 -1981 4 -1091 0 -1988 -3 -1991 -7z"/>
                <path d="M4227 4472 l-327 -327 -2 -1005 -3 -1005 -1000 -3 -1000 -2 -330
                -330 -330 -330 1658 0 1657 0 0 335 0 335 392 -2 393 -3 123 -215 c68 -118
                154 -267 191 -330 l67 -115 377 -3 c207 -1 377 0 377 3 0 2 -22 42 -49 87 -46
                77 -1130 1958 -1218 2113 -22 39 -84 147 -138 240 -54 94 -130 226 -170 295
                -40 69 -98 170 -130 225 -32 55 -91 158 -132 230 -41 71 -75 130 -76 132 -2 1
                -150 -145 -330 -325z m375 -1064 c20 -35 104 -181 187 -325 83 -144 151 -267
                151 -273 0 -6 -67 -10 -195 -10 l-195 0 0 335 c0 184 4 335 8 335 4 0 24 -28
                44 -62z"/>
                <path d="M2898 3139 l-318 -324 317 -3 c174 -1 318 -1 320 1 2 2 2 149 1 327 l-3 323 -317 -324z"/>
              </g>
            </svg>
          </div>
          <h1>TOAMIG</h1>
        </div>
        <h1>Welcome to my <span class="strong-text">Game Developer</span> Portfolio</h1>
        <p>Discover my projects, skills, and experience</p>
      </div>
      <div class="scroll-down">
        <a href="#content"></a>
      </div>
    </div>

    <div id="content">
      <section id="about">
        <div class="container">
          <div class="about-content">
            <img src="me/IMG_7.JPEG" alt="Profile Picture" class="profile-image">
            <div class="about-text">
              <h2>Summary</h2>
              <span class="underline"></span>
              <p class="p1">My name is Miguel "Toamig" Vieira, and I'm a software engineer specialized in game development and interactive systems.</p>
              <p class="p3">My experience spans nearly every area of game programming, including Gameplay, Multiplayer, Tools, Animation, and AI.</p>
              <p class="p2">Currently I'm working as a Lead Software Engineer at Flama Craftworks, where I'm responsible for the gameplay development of the Timefront project.</p>
            </div>
          </div>
        </div>
      </section>

      <section id="education">
        <div class="container">
          <h2>Education</h2>
          <span class="underline"></span>
          <div class="cards-container">
            <a class="extended-card" href="https://sigarra.up.pt/feup/en/" target="_blank" rel="noopener noreferrer">
              <img src="education/feup-logo.png" alt="feup Logo" class="card-logo">
              <div class="card-details">
                <h3>U.Porto - FEUP</h3>
                <p class="role">Software Engineering Bachelor</p>
                <p class="time-period">2016 - 2021</p>
              </div>
            </a>
            <a class="extended-card" href="https://sigarra.up.pt/feup/en/" target="_blank" rel="noopener noreferrer">
              <img src="education/feup-logo.png" alt="feup Logo" class="card-logo">
              <div class="card-details">
                <h3>U.Porto - FEUP</h3>
                <p class="role">Software Engineering Masters</p>
                <p class="time-period">2021 - Ongoing</p>
              </div>
            </a>
          </div>
        </div>
      </section>

      <section id="experience">
        <div class="container">
          <h2>Work Experience</h2>
          <span class="underline"></span>
          <div class="cards-container">
            <a class="extended-card" href="https://www.linkedin.com/company/dive-studios-porto/" target="_blank" rel="noopener noreferrer">
              <img src="experience/dive.jfif" alt="Dive Studios Logo" class="card-logo">
              <div class="card-details">
                <h3>Dive Studios</h3>
                <p class="role">Team Leader</p>
                <p class="time-period">Feb 2021 - Jun 2021</p>
              </div>
            </a>
            <a class="extended-card" href="https://shadowprofile.pt/" target="_blank" rel="noopener noreferrer">
              <img src="experience/shadowprofile.png" alt="Shadow Profile Logo" class="card-logo">
              <div class="card-details">
                <h3>Shadow Profile</h3>
                <p class="role">Unity Game Developer</p>
                <p class="time-period">May 2022 - Aug 2022</p>
              </div>
            </a>
            <a class="extended-card" href="https://saberporto.com/" target="_blank" rel="noopener noreferrer">
              <img src="experience/saber.jfif" alt="Saber Interactive Logo" class="card-logo">
              <div class="card-details">
                <h3>Saber Interactive</h3>
                <p class="role">Tools Lead Programmer</p>
                <p class="time-period">Aug 2022 - Jan 2024</p>
              </div>
            </a>
            <!--<a class="extended-card" href="" target="_blank" rel="noopener noreferrer">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=" alt="Ikonic Games Logo" class="card-logo">
              <div class="card-details">
                <h3>Ikonic Games</h3>
                <p class="role">Core Software Engineer</p>
                <p class="time-period">Fev 2024 - Fev 2025</p>
              </div>
            </a>-->
            <a class="extended-card" href="https://www.flamacraftworks.com/" target="_blank" rel="noopener noreferrer">
              <img src="experience/flama.jpg" alt="Flama Craftworks Logo" class="card-logo">
              <div class="card-details">
                <h3>Flama Craftworks</h3>
                <p class="role">Lead Software Engineer</p>
                <p class="time-period">Mar 2025 - Present</p>
              </div>
            </a>
          </div>
        </div>
      </section>

      <section id="technologies">
        <div class="container">
          <h2>Professional Proficiency</h2>
          <span class="underline"></span>
          <div class="cards-container">
            <div class="tech-card">
              <img class="tech-logo" src="technologies/c%23.svg" alt="C#">
              <h3>C#</h3>
            </div>
            <div class="tech-card">
              <img class="tech-logo" src="technologies/c++.svg" alt="C++">
              <h3>C++</h3>
            </div>
            <div class="tech-card">
              <img class="tech-logo" src="technologies/unity.svg" alt="Unity">
              <h3>Unity</h3>
            </div>
            <div class="tech-card">
              <img class="tech-logo" src="technologies/unreal.svg" alt="Unreal">
              <h3>Unreal</h3>
            </div>
            <div class="tech-card">
              <img class="tech-logo" src="technologies/houdini.svg" alt="Houdini">
              <h3>Houdini</h3>
            </div>
          </div>
        </div>
      </section>

      <section id="projects">
        <div class="container">
          <h2>Professional Projects</h2>
          <span class="underline"></span>
          <div class="cards-container">
            <a class="project-card" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.7)), url('projects/autorocket.png')" href="https://toamig.itch.io/autorocket" target="_blank" rel="noopener noreferrer"> <!-- "https://fb.watch/lQlTru9G4J/" -->
              <div class="project-details">
                <h3>AutoRocket</h3>
                <p>Educative rocket simulator with visual programming.</p>
              </div>
            </a>
            <a class="project-card" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.7)), url('projects/totally-basketball.jpg')" href="https://www.meta.com/experiences/totally-basketball/6781908485204434/" target="_blank" rel="noopener noreferrer">
              <div class="project-details">
                <h3>Totally Basketball</h3>
                <p>VR basketball game.</p>
              </div>
            </a>
            <a class="project-card" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.7)), url('projects/cape.jpg')" href="https://www.aotearoaexplorers.nz/" target="_blank" rel="noopener noreferrer">
              <div class="project-details">
                <h3>Aotearoa Explorers</h3>
                <p>Educative exploration game.</p>
              </div>
            </a>
            <a class="project-card" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.7)), url('projects/dakar.jpg')" href="https://store.steampowered.com/app/1839940/Dakar_Desert_Rally" target="_blank" rel="noopener noreferrer">
              <div class="project-details">
                <h3>Dakar Desert Rally</h3>
                <p>Open world rally Dakar simulator game.</p>
              </div>
            </a>
            <a class="project-card" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.7)), url('projects/RoadKings.avif')" href="https://store.steampowered.com/app/2141130/Road_Kings/" target="_blank" rel="noopener noreferrer">
              <div class="project-details">
                <h3>Road Kings</h3>
                <p>Adventure truck simulator.</p>
              </div>
            </a>
            <a class="project-card" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.7)), url('projects/timefront.jpg')" href="https://store.steampowered.com/app/3328840/Timefront/" target="_blank" rel="noopener noreferrer">
              <div class="project-details">
                <h3>Timefront</h3>
                <p>RTS game blending battle royale mechanics.</p>
              </div>
            </a>
          </div>
        </div>
      </section>
    </div>

    <footer>
      <div class="container">
        <div class="social-icons">
          <a href="https://www.linkedin.com/in/toamig/" target="_blank" rel="noopener noreferrer">
            <img src="socials/linkedin.svg" class="logo" alt="Linkedin">
          </a>
          <a href="https://www.instagram.com/toamig/" target="_blank" rel="noopener noreferrer">
            <img src="socials/insta.svg" class="logo" alt="Instagram">
          </a>
          <a href="https://github.com/toamig" target="_blank" rel="noopener noreferrer">
            <img src="socials/github.svg" class="logo" alt="Github">
          </a>
          <a href="https://t.me/cvieiratoa" target="_blank" rel="noopener noreferrer">
            <img src="socials/telegram.svg" class="logo" alt="Telegram">
          </a>
        </div>
        <p>&copy; 2025 Toamig's Game Developer Portfolio. All rights reserved.</p>
      </div>
    </footer>
  </body>
</html>